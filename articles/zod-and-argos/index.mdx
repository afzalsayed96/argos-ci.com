---
title: Enforce API Stability with Zod and Argos
description: "Argos and Zod are the ultimate duo for ensuring API stability across your whole app at low cost."
category: API testing
author: Jeremy Sfez
date: 2023-12-12
image: ./main.png
imageAlt: Developer at work
---

API changes frequently result in broken applications, largely due to the difficulty in monitoring their ripple effects. This article discusses the practical benefits of using Zod in tandem with Argos to tackle this issue and enhance API stability. It focuses on enforcing the integrity of API responses and detecting regressions through visual testing.

<MainImage />

## Zod: Streamlining Type Safety

[Zod](https://zod.dev/) is a TypeScript-first library for schema declaration and validation. It excels in enforcing type safety, a crucial aspect in early error detection.

In addition, Zod serves as an excellent tool for ensuring API response integrity and maintains the API contract over time. With Zod, frontend developers can rely on type safety, while backend developers can quickly identify regressions in API responses.

```typescript
// Zod schema example for API response testing
import { z } from "zod";

const SneakerSchema = z.object({
  id: z.number(),
  picture: z.string(),
  price: z.number(),
  description: z.string(),
  brand: z.string(),
});

const getSneakers = async () => {
  const response = await fetch("/api/sneakers");
  if (!response.ok) throw new Error("API error");
  const data = await response.json();
  SneakerSchema.parse(data); // Validates against the schema
};
```

Zod ensures API integrity, but manually checking each route after updates is impractical. Argos streamlines this, safeguarding the entire app more efficiently.

## Argos: Simplifying Visual Testing

[Argos](https://argos-ci.com/docs) integrates with CI/CD pipelines, facilitating UI change verification within pull requests. It streamlines visual regression detection, essential for maintaining consistent user experiences.

```typescript
// Capture screenshots of your app with Argos
import { argosScreenshot } from "@argos-ci/playwright";
import { test } from "@playwright/test";

const baseUrl = "http://localhost:3000";
const pages = [
  { name: "homepage", path: "/" },
  { name: "product-list", path: "/explore" },
  { name: "product-detail", path: "/preview/404758" },
  { name: "faq", path: "/faq" },
  { name: "contact", path: "/contact-us" },
];

test("screenshot pages", async ({ page }) => {
  for (const { name, path } of pages) {
    await page.goto(`${baseUrl}${path}`);
    await argosScreenshot(page, name);
  }
});
```

## The Combined Impact of Zod and Argos

Utilizing Zod in tandem with Argos empowers developers to swiftly pinpoint and address broken pages caused by API modifications throughout their application. When Zod flags a type error during runtime, which might lead to a blank page, Argos steps in to detect this visual regression. It then delivers prompt feedback during code reviews, enhancing the overall development process.

The best part is that this approach is easy to implement. All you need to do is add a few lines of code to your E2E test suite to get feedback directly on your pull-request.

[![Zod error detected in Argos](https://res.cloudinary.com/smooth/image/upload/v1702403606/Argos/app.argos-ci.com_argos-ci_snkr-shop_builds_24_67606393_1.png)](https://app.argos-ci.com/argos-ci/snkr-shop/builds/24/67606393)

### Key Benefits for Developers

- **Fast Feedback**: Quick identification of API contract issues.
- **High Coverage**: Cover all pages with a single line of code.
- **No Maintenance**: No need to update your tests when UI or API changes.
- **Reliability**: Detects both type and visual regressions effectively.

## Conclusion

The synergy of Argos and Zod redefine API contract testing, seamlessly bridging data integrity with UI consistency. This powerful combination not only makes monitoring API changes across applications both efficient and cost-effective but also integrates effortlessly into your workflow. It's a tool set that empowers developers with rapid feedback, streamlining the path to a more robust and swiftly delivered product.
